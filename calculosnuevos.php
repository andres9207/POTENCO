<?PHP
//lista de parametros
// fes = G5 || F5
// totalhoras =  Q5
// horario = R5
// hit = M5 =>hora inicial tarde
// hft = O5 =>hora final tarde
// horamanana = L5
// HENF = AA5
// him = I5 => hora inicial maÃ±ana
// fesa = F6 || G6
// horastarde = P5
// pagado y compensado = T5
// compensado = S5
// HEDF = Y5
// HNF = AC5
// PERMISO REMUNERADO = U5
// HDF = X5
// HENO = Z5
// RD = AD5


//=SI(O(G5=1;F5=1);((SI(Y(Q5>8;O5>0,916666666666667);O5-0,916666666666667;0)+SI(Y(Q5>8;O5<0,25;L5=0);ABS(M5-(1+O5)+(8/24));0))*24)+((SI(Y(Q5>8;O5<0,25;O5<>0;L5<>0);O5+0,0833333333333333;0))*24);0)+SI(Y(O(G6=1;F6=1);Y(F5<>1;G5<>1);O5<(6/24));O5*24;0)-SI(Y(F6<>1;G6<>1;O(F5=1;G5=1);O5<(6/24));O5*24;0)
$HENF = 0;
$HENF = (($G5==1 || $F5==1)?(((($Q5>8 and $O5>0.916666666666667)?$O5-0.916666666666667:0)+(($Q5>8 and $O5<0.25 and $L5==0)?abs($M5-(1+$O5)+(8/24)):0))*24)+(((($Q5>8 and $O5<0.25 and $O5<>0 and $L5<>0)?$O5+0.0833333333333333:0))*24):0)+((($G6==1 || $F6==1) and ($F5<>1 and $G5<>1) and $O5<(6/24))?$O5*24:0)-(($F6<>1 and $G6<>1 and ($F5==1 || $G5==1) and $O5<(6/24))?$O5*24:0);

$HENO = 0; // HORAS EXTRAS NOCTURNAS ORDINARIAS
//EXCELL
//=SI(O(G5=1;F5=1);0;((SI(Y(Q5>R5;O5>0,916666666666667);ABS(M5+(R5/24)-(O5));0)+SI(Y(Q5>R5;O5<0,25;L5=0);ABS(M5-(1+O5)+(R5/24));0))*24)+((SI(Y(Q5>R5;O5<0,25;O5<>0;L5<>0);O5+0,0833333333333333;0))*24)-AA5+SI(Y(I5<0,25;I5<>0;Q5>R5);SI(((0,25-I5)*24)>(Q5-R5);Q5-R5;(0,25-I5)*24)))+SI(Y(F6<>1;G6<>1;O(F5=1;G5=1);O5<(6/24));O5*24;0)
$HENO=(($G5==1 || $F5==1)?0:(((($Q5>$R5 and $O5>0.916666666666667)?abs($M5+($R5/24)-($O5)):0)+(($Q5>$R5 and $O5<0.25 and $L5==0)?abs($M5-(1+$O5)+($R5/24)):0))*24)+(((($Q5>$R5 and $O5<0.25 and $O5<>0 and $L5<>0)?$O5+0.0833333333333333:0))*24)-$AA5+(($I5<0.25 and $I5<>0 and $Q5>$R5)?(((0.25-$I5)*24)>($Q5-$R5)?$Q5-$R5:(0.25-$I5)*24):0))+(($F6<>1 and $G6<>1 and ($F5==1 || $G5==1) and $O5<(6/24))?$O5*24:0);

$HEDF = 0; 
//EXCELL
//=SI(Y(O(G5=1;F5=1);Q5>8);Q5-8;0)-AA5+SI(Y(O(G6=1;F6=1);Y(G5<>1;F5<>1);AA5>0);O5*24;0)-SI(Y(F6<>1;G6<>1;O(F5=1;G5=1);O5<(6/24));O5*24;0)
$HEDF = ((($G5==1|| $F5==1) and $Q5>8)?$Q5-8:0)-$AA5+((($G6==1 ||$F6==1) and ($G5<>1 and $F5<>1) and $AA5>0)?$O5*24:0)-(($F6<>1 and $G6<>1 and ($F5==1 || $G5==1) and $O5<(6/24))?$O5*24:0);

$HNF  = 0;
//Excel
//=((SI(Y(O(F5=1;G5=1);L5=0;M5>0,583333333333333;O5>0,916666666666667);M5+(8/24)-(22/24);0)*24))+((SI(Y(O(F5=1;G5=1);L5=0;M5>0,583333333333333;O5<0,25);M5+((P5/24)-1)+(0,0833333333333);0))*24)-SI(Y(O(F5=1;G5=1);P5>8;L5=0;M5>0,583333333333333;O5<0,25);(P5-8);0)+SI(Y(O(F5=1;G5=1);I5<0,25;I5<>0);(0,25-I5)*24;0)
$HNF = ((((($F5==1 || $G5==1) and $L5=0 and $M5>0.583333333333333 and $O5>0.916666666666667)?$M5+(8/24)-(22/24):0)*24))+((((($F5==1 ||$G5==1)and $L5==0 and $M5>0.583333333333333 and $O5<0.25)?$M5+(($P5/24)-1)+(0.0833333333333):0))*24)-((($F5==1 || $G5==1) and $P5>8 and $L5==0 and $M5>0.583333333333333 and $O5<0.25)?($P5-8):0)+((($F5==1 || $G5==1) and $I5<0.25 and $I5<>0)?(0.25-$I5)*24:0);

$RD = 0;
//EXCELL
//=SI(T5="SI";0;SI(Y(O(G5=1;F5=1);O(S5="SI";S5="Ambos"));SI(Q5<=8;Q5;8);0))
$RD = ($T5=="SI"?0:((($G5==1 || $F5==1) and ($S5=="SI" || $S5=="Ambos"))?($Q5<=8?$Q5:8):0));

$RN = 0;
//EXCELL
//=SI(O(G5=1;F5=1);0;((SI(Y(L5=0;M5>=0,583333333333333;O5>0,916666666666667;Q5<=R5);M5+(R5/24)-(22/24);0)))*24+((SI(Y(L5=0;M5>0,583333333333333;O5<0,25);M5+((P5/24)-1)+(0,0833333333333);0))*24)-SI(Y(P5>8;L5=0;M5>0,583333333333333;O5<0,25);(P5-R5);0)+SI(Y(I5<0,25;I5<>0;Q5<=R5);(0,25-I5);0)*24)+SI(Y(I5<(6/24);Q5>R5;(0,25-I5)>(Q5/24-R5/24);I5<>0);(0,25-I5)-(Q5/24-R5/24);0)*24
$RN = (($G5==1 || $F5==1)?0:(((($L5==0 and $M5>=0.583333333333333 and $O5>0.916666666666667 and $Q5<=$R5)?$M5+($R5/24)-(22/24):0)))*24 +(((($L5==0 and $M5>0.583333333333333 and $O5<0.25)?$M5+(($P5/24)-1)+(0.0833333333333):0))*24)-(($P5>8 and $L5==0 and $M5>0.583333333333333 and $O5<0.25)?($P5-$R5):0)+(($I5<0.25 and $I5<>0 and $Q5<=$R5)?(0.25-$I5):0)*24)+(($I5<(6/24) and $Q5>$R5 and (0.25-$I5)>($Q5/24-$R5/24) and $I5<>0)?(0.25-$I5)-($Q5/24-$R5/24):0)*24;


$HDF  = 0;
//EXCELL
//=SI(O(G5=1;F5=1);Q5;0)-Y5-AA5+SI(Y(O(G6=1;F6=1);AA5>0;Y(G5<>1;F5<>1));O5*24;0)-SI(Y(O(G5=1;F5=1);S5="SI";T5="");SI(Q5<=8;Q5;"8");0)-SI(Y(F6<>1;G6<>1;O(F5=1;G5=1);O5<(6/24));O5*24;0)-AC5
$HDF = (($G5==1 || $F5==1)?$Q5:0)-$Y5-$AA5+((($G6==1 || $F6==1) and $AA5>0 and ($G5<>1 and $F5<>1))?$O5*24:0)-((($G5==1 || $F5==1) and $S5=="SI" and  $T5=="")?($Q5<=8?$Q5:"8"):0)-(($F6<>1 and $G6<>1 and ($F5==1 || $G5==1) and $O5<(6/24))?$O5*24:0)-$AC5;

$HEDO = 0; // HORAS EXTRAS DIURNAS ORDINA
//EXCELL
//=SI(R5>Q5;SI(U5="SI";0;Q5-R5);Q5-R5)-X5-Z5-AA5-Y5-AC5-AD5
$HEDO = ($R5>$Q5?($U5="SI"?0:$Q5-$R5):$Q5-$R5)-$X5-$Z5-$AA5-$Y5-$AC5-$AD5;


((0==1 || 0==1)?0:((((0==0 and 0,66666666666667>=0.583333333333333 and 0,95833333333333>0.916666666666667 and 7<=8)?0,66666666666667+(8/24)-(22/24):0)))*24 +((((0==0 and 0,66666666666667>0.583333333333333 and 0,95833333333333<0.25)?0,66666666666667+((7/24)-1)+(0.0833333333333):0))*24)-((7>8 and 0==0 and 0,66666666666667>0.583333333333333 and 0,95833333333333<0.25)?(7-8):0)+((0<0.25 and 0<>0 and 7<=8)?(0.25-0):0)*24)+((0<(6/24) and 7>8 and (0.25-0)>(7/24-8/24) and 0<>0)?(0.25-0)-(7/24-8/24):0)*24
?>

